# 6 畳込みニューラルネット
## 6.1 単純型細胞と複雑型細胞
WIP

---
## 6.2 全体の構造

<img src="./imgs/06畳込みニューラルネット/全体の構成/全体の構成.png" style="border:solid 1px grey">

<img src="./imgs/06畳込みニューラルネット/全体の構成/畳込み層とプーリング層について.png">

<img src="./imgs/06畳込みニューラルネット/全体の構成/局所コントラスト正規化層について.png">

<img src="./imgs/06畳込みニューラルネット/全体の構成/全結合層について①.png">

<img src="./imgs/06畳込みニューラルネット/全体の構成/全結合層について②.png">

<img src="./imgs/06畳込みニューラルネット/全体の構成/出力層について.png">

---
## 6.3 畳込み
### 6.3.1 定義
濃淡値を各画素に格納したグレースケールの画像を考えます。

 - 画像サイズを$W \times W$画素
 - 画素をインデックス$\left(i,j\right)$ $(i = 0,\dots,W-1, j = 0, \dots, W - 1)$
 - 画素$\left(i,j\right)$の画素値を$x_{ij}$($- \infty \le x_{ij} \le + \infty$)

<b>フィルタ(filter)</b>と呼ぶサイズの小さい画像を考え、そのサイズを$H \times H$画素とします。

 - フィルタの画素をインデックス$\left( p, q \right)$ $(p=0, \dots, H-1, q = 0, \dots, H-1)$
 - フィルタの画素値を$h_{pq}$
 - フィルタの画素値は任意の実数値

画像の畳込みとは、画像とフィルタ間で定義される次の積和計算です。

$$
u_{ij} = \sum _{p=0}^{H-1}{ \sum _{q=0}^{H-1}{ x_{i+p, j+p} h_{pq} } } \qquad (6.1)
$$

<img src="./imgs/06畳込みニューラルネット/畳込みの定義.png">

計算例:

|       →         |        ↩︎        |
| :-------------: | :-------------: |
| <img src="./imgs/06畳込みニューラルネット/畳込みの計算例①.png"> | <img src="./imgs/06畳込みニューラルネット/畳込みの計算例②.png"> |
| <img src="./imgs/06畳込みニューラルネット/畳込みの計算例③.png"> | <img src="./imgs/06畳込みニューラルネット/畳込みの計算例④.png"> |
| <img src="./imgs/06畳込みニューラルネット/畳込みの計算例⑤.png"> | <img src="./imgs/06畳込みニューラルネット/畳込みの計算例⑥.png"> |
| <img src="./imgs/06畳込みニューラルネット/畳込みの計算例⑦.png"> | <img src="./imgs/06畳込みニューラルネット/畳込み計算/畳込み計算の例⑧.png"> |


### 6.3.2 畳込みの働き
画像の畳込みは、フィルタの濃淡パターンと類似した濃淡パターンが入力画像上のどこにあるかを検出する働きがあります。つまり、フィルタが表す特徴的な濃淡構造を画像から抽出する働きです。

<img src="./imgs/06畳込みニューラルネット/畳込みの働き/フィルタの畳込み結果の例.png">

> 512 × 512のサイズの画像に17×17のサイズのフィルタ2種類を畳込んでいます。フィルタはわかりやすいように拡大表示しています(画像よりも相対的に大きく見えています)。またフィルタと畳込み結果の画像は、負の画素値が黒く、正が白くなるように濃淡値を調整してあります。

<img src="./imgs/06畳込みニューラルネット/畳込みの働き/フィルタの畳込み結果の例①.png">

<img src="./imgs/06畳込みニューラルネット/畳込みの働き/フィルタの畳込み結果の例②.png">

### 6.3.3 パディング


### 6.3.4 ストライド


---
## 6.4 畳込み層

---
## 6.5 プーリング層


---
## 6.6 正規化層
### 6.6.1 局所コントラスト正規化


### 6.6.2 単一チャンネル画像の正規化


### 6.6.3 多チャンネル画像の正規化

---
## 6.7 勾配の計算
